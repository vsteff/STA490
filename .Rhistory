getwd()
load("glu_v01.RData")
CV <- function(mean, sd) (sd/mean)*100
glu$cv <- glu$high.var <- rep(NA, nrow(glu))
npatients <- length(unique(glu$PID))  # 41428
for (i in 1:npatients) {  # i: patient
pat.glu <- glu[which(as.numeric(glu$PID) == i), "Glu"]
pat.inp <- glu[which(as.numeric(glu$PID) == i), "Inpatient"]
glu[which(as.numeric(glu$PID) == i), "cv"] <- ifelse(pat.inp == TRUE, CV(mean(pat.glu), sd(pat.glu)), NA)
}
glu$high.var <- ifelse(glu$cv > 15, 1, 0)
glu[1:100, c("PID", "Time", "Inpatient", "cv", "high.var")]
summary(glu$high.var)
table(glu$high.var)
glu$high.var2 <- ifelse(glu$cv > 20, 1, 0)
table(glu$high.var)
table(glu$high.var2)
which(as.numeric(glu$PID) == 1:50)
glu[which(as.numeric(glu$PID) <= 50), c("PID", "Time", "Inpatient", "cv", "high.var")]
glu[which(as.numeric(glu$PID) <= 100), c("PID", "Time", "Inpatient", "cv", "high.var")]
glu[which(as.numeric(glu$PID) <= 200), c("PID", "Time", "Inpatient", "cv", "high.var")]
i <- 196
pat.glu <- glu[which(as.numeric(glu$PID) == i), "Glu"]
pat.glu
table(glu$high.var)
table(glu$high.var2)
save(glu, file = "glu_v02.RData")
